import { Telegraf } from 'telegraf';
import * as dotenv from 'dotenv';

dotenv.config();

const bot = new Telegraf(process.env.BOT_TOKEN!);

const targetBotMention = 'mafiauabot'; // Ð±ÐµÐ· @ Ð´Ð»Ñ Ð·Ñ€ÑƒÑ‡Ð½Ð¾ÑÑ‚Ñ– Ð¿Ð¾Ñ€Ñ–Ð²Ð½ÑÐ½Ð½Ñ

const tips = [
    'ðŸ’¡ Ð”Ñ–Ð¹Ñ‚Ðµ Ð¾Ð±Ð´ÑƒÐ¼Ð°Ð½Ð¾. Ð£ Ð¿ÐµÑ€ÑˆÑ– Ð´Ð½Ñ– Ð³Ñ€Ð¸ ÑƒÑ‚Ñ€Ð¸Ð¼Ð°Ð¹Ñ‚ÐµÑÑŒ Ð²Ñ–Ð´ Ñ…Ð°Ð¾Ñ‚Ð¸Ñ‡Ð½Ð¸Ñ… Ð³Ð¾Ð»Ð¾ÑÑƒÐ²Ð°Ð½ÑŒ. Ð Ð°Ð½Ð´Ð¾Ð¼Ð½Ñ– Ñ€Ñ–ÑˆÐµÐ½Ð½Ñ Ð¼Ð¾Ð¶ÑƒÑ‚ÑŒ Ð¿Ñ€Ð¸Ð·Ð²ÐµÑÑ‚Ð¸ Ð´Ð¾ Ð·Ð°Ð³Ð¸Ð±ÐµÐ»Ñ– Ð¼Ð¸Ñ€Ð½Ð¾Ð³Ð¾ Ð¶Ð¸Ñ‚ÐµÐ»Ñ Ð°Ð±Ð¾ Ð·Ñ€Ð¾Ð±Ð¸Ñ‚Ð¸ Ð²Ð°Ñ Ð»ÐµÐ³ÐºÐ¾ÑŽ Ð¼Ñ–ÑˆÐµÐ½Ð½ÑŽ.',
    'ðŸŸ¢ Ð‘ÑƒÐ´ÑŒÑ‚Ðµ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¸Ð¼Ð¸. ÐÐ°Ð²Ñ–Ñ‚ÑŒ ÑÐºÑ‰Ð¾ Ð²Ð°Ð¼ Ð²Ð¸Ð¿Ð°Ð»Ð° Ð¼Ð¸Ñ€Ð½Ð° Ñ€Ð¾Ð»ÑŒ, Ð½Ðµ Ñ–Ð³Ð½Ð¾Ñ€ÑƒÐ¹Ñ‚Ðµ Ð³Ñ€Ñƒ. Ð’Ð°ÑˆÐ° Ð²Ñ–Ð´ÑÑƒÑ‚Ð½Ñ–ÑÑ‚ÑŒ Ð¿Ð¾ÑÐ»Ð°Ð±Ð»ÑŽÑ” ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ Ñ– Ð¼Ð¾Ð¶Ðµ Ð¿Ñ€Ð¸Ð·Ð²ÐµÑÑ‚Ð¸ Ð´Ð¾ Ð¿Ñ€Ð¾Ð³Ñ€Ð°ÑˆÑƒ.',
    'ðŸ•µï¸ Ð¯ÐºÑ‰Ð¾ Ð²Ð¸ Ð¡Ð»Ñ–Ð´Ñ‡Ð¸Ð¹. ÐŸÑ€Ð¸ Ð¿ÐµÑ€ÐµÐ²Ñ–Ñ€Ñ†Ñ– Ð¼Ð¸Ñ€Ð½Ð¾Ð³Ð¾ Ð³Ñ€Ð°Ð²Ñ†Ñ Ð¿Ð¾Ð²Ñ–Ð´Ð¾Ð¼Ð»ÑÐ¹Ñ‚Ðµ Ð»Ð¸ÑˆÐµ Ð¿Ñ€Ð¾ Ð¹Ð¾Ð³Ð¾ "Ð¼Ð¸Ñ€Ð½Ð¸Ð¹" ÑÑ‚Ð°Ñ‚ÑƒÑ, Ð½Ðµ Ñ€Ð¾Ð·ÐºÑ€Ð¸Ð²Ð°ÑŽÑ‡Ð¸ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ñƒ Ñ€Ð¾Ð»ÑŒ.',
    'ðŸ•µï¸ Ð¯ÐºÑ‰Ð¾ Ð²Ð¸ Ð¡Ð»Ñ–Ð´Ñ‡Ð¸Ð¹. Ð¡Ð»Ñ–Ð´ÐºÑƒÐ¹Ñ‚Ðµ Ð·Ð° Ñ€Ð°Ñ…ÑƒÐ½ÐºÐ¾Ð¼, Ñ‚Ñ€Ð¸Ð¼Ð°Ð¹Ñ‚Ðµ Ð¿Ñ–Ð´ ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»ÐµÐ¼ ÐºÑ–Ð»ÑŒÐºÑ–ÑÑ‚ÑŒ Ð¼Ð°Ñ„Ñ–Ñ—. Ð£ ÐºÑ€Ð¸Ñ‚Ð¸Ñ‡Ð½Ð¸Ñ… Ð¼Ð¾Ð¼ÐµÐ½Ñ‚Ð°Ñ… Ð´Ñ–Ð¹Ñ‚Ðµ ÑˆÐ²Ð¸Ð´ÐºÐ¾ Ð¹ Ñ€Ñ–ÑˆÑƒÑ‡Ðµ.',
    'ðŸ•µï¸ Ð¯ÐºÑ‰Ð¾ Ð²Ð¸ Ð¡Ð»Ñ–Ð´Ñ‡Ð¸Ð¹. Ð¢Ð° Ð²Ð¸ÑÐ²Ð¸Ð»Ð¸ Ð¼Ð°Ñ„Ñ–Ð¾Ð·Ñ–, ÐºÑ€Ð°Ñ‰Ðµ Ð¿Ð¾Ð²Ñ–Ð´Ð¾Ð¼Ð¸Ñ‚Ð¸ Ð¿Ñ€Ð¾ Ñ†Ðµ ÑÐ°Ð¼Ð¾ÑÑ‚Ñ–Ð¹Ð½Ð¾, Ð° Ð½Ðµ Ñ‡ÐµÑ€ÐµÐ· Ñ–Ð½ÑˆÐ¸Ñ… Ð³Ñ€Ð°Ð²Ñ†Ñ–Ð².',
    'ðŸ’‰ Ð¯ÐºÑ‰Ð¾ Ð²Ð¸ Ð›Ñ–ÐºÐ°Ñ€. ÐŸÑ€Ñ–Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚ Ñƒ Ð»Ñ–ÐºÑƒÐ²Ð°Ð½Ð½Ñ– â€” Ð²Ñ–Ð´ÐºÑ€Ð¸Ñ‚Ñ– Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ– Ñ€Ð¾Ð»Ñ–, Ð¾ÑÐ¾Ð±Ð»Ð¸Ð²Ð¾ Ñ‚Ñ–, Ñ‰Ð¾ Ð½Ð°Ð´Ð°ÑŽÑ‚ÑŒ ÐºÑ€Ð¸Ñ‚Ð¸Ñ‡Ð½Ð¾ Ð²Ð°Ð¶Ð»Ð¸Ð²Ñƒ Ñ–Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ñ–ÑŽ Ð´Ð»Ñ Ð¼Ñ–ÑÑ‚Ð°.',
    'ðŸ’‰ Ð¯ÐºÑ‰Ð¾ Ð²Ð¸ Ð›Ñ–ÐºÐ°Ñ€. Ð¢Ð° Ð¾Ð´Ð½Ð¾Ñ‡Ð°ÑÐ½Ð¾ Ð²Ñ–Ð´ÐºÑ€Ð¸Ð»Ð¸ÑÑ Ð¡Ð»Ñ–Ð´Ñ‡Ð¸Ð¹ Ñ‚Ð° Ð–ÑƒÑ€Ð½Ð°Ð»Ñ–ÑÑ‚ÐºÐ°, Ð¾Ð±Ð¸Ñ€Ð°Ð¹Ñ‚Ðµ Ð´Ð»Ñ Ð·Ð°Ñ…Ð¸ÑÑ‚Ñƒ Ð¡Ð»Ñ–Ð´Ñ‡Ð¾Ð³Ð¾ â€” Ð½Ð°ÑÐ²Ð½Ñ–ÑÑ‚ÑŒ Ð¿Ñ–ÑÑ‚Ð¾Ð»ÐµÑ‚Ñƒ Ð³Ñ€Ð°Ñ” ÐºÐ»ÑŽÑ‡Ð¾Ð²Ñƒ Ñ€Ð¾Ð»ÑŒ.',
    'ðŸ’‰ Ð¯ÐºÑ‰Ð¾ Ð²Ð¸ Ð›Ñ–ÐºÐ°Ñ€. Ð£Ð½Ð¸ÐºÐ°Ð¹Ñ‚Ðµ Ð¿Ð¾ÑÑ‚Ñ–Ð¹Ð½Ð¾Ð³Ð¾ Ð»Ñ–ÐºÑƒÐ²Ð°Ð½Ð½Ñ Ð¾Ð´Ð½Ð¾Ð³Ð¾ Ð³Ñ€Ð°Ð²Ñ†Ñ Ð´Ð¾Ð¿Ð¾ÐºÐ¸ Ð½Ðµ Ð²Ñ–Ð´ÐºÑ€Ð¸Ñ‚Ñ– Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ– Ñ€Ð¾Ð»Ñ– â€” Ð¼Ð°Ñ„Ñ–Ñ Ð¼Ð¾Ð¶Ðµ Ð²Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð°Ñ‚Ð¸ Ñ†Ðµ Ð´Ð»Ñ Ð²Ñ–Ð´Ð²Ð¾Ð»Ñ–ÐºÐ°Ð½Ð½Ñ. (Ð Ð˜Ð—Ð˜ÐšÐžÐ’ÐÐÐž!)',
    'ðŸ§¥ Ð¯ÐºÑ‰Ð¾ Ð²Ð¸ Ð’Ð¾Ð»Ð¾Ñ†ÑŽÐ³Ð°. Ð¢Ð° ÐºÐ¾Ð³Ð¾ÑÑŒ Ð¿Ð¾Ð±Ð°Ñ‡Ð¸Ð»Ð¸ Ð² Ð¾Ð´Ð½Ð¾Ð³Ð¾ Ð· Ð³Ñ€Ð°Ð²Ñ†Ñ–Ð², Ð¿ÐµÑ€Ñˆ Ð½Ñ–Ð¶ Ð´Ñ–Ð»Ð¸Ñ‚Ð¸ÑÑ Ñ–Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ñ–Ñ”ÑŽ, Ð¿ÐµÑ€ÐµÐºÐ¾Ð½Ð°Ð¹Ñ‚ÐµÑÑŒ, Ñ…Ñ‚Ð¾ Ð±ÑƒÐ² Ð£Ð‘Ð˜Ð¢Ð˜Ð™ Ð’ÐÐžÐ§Ð†.',
    'ðŸ§¥ Ð¯ÐºÑ‰Ð¾ Ð²Ð¸ Ð’Ð¾Ð»Ð¾Ñ†ÑŽÐ³Ð°. Ð£ Ñ€Ð°Ð·Ñ– ÑÐ¼ÐµÑ€Ñ‚Ñ– Ð›Ñ–ÐºÐ°Ñ€Ñ ÐºÑ€Ð°Ñ‰Ðµ Ð¿Ñ€Ð¾Ð¿ÑƒÑÑ‚Ð¸Ñ‚Ð¸ Ð¿ÐµÑ€ÑˆÑƒ Ð½Ñ–Ñ‡ Ð· Ð²Ñ–Ð·Ð¸Ñ‚Ð¾Ð¼ Ð´Ð¾ Ð¡Ð»Ñ–Ð´Ñ‡Ð¾Ð³Ð¾, Ñ‰Ð¾Ð± ÑÐ¿Ñ€Ð¾Ð±ÑƒÐ²Ð°Ñ‚Ð¸ Ð¿Ñ€Ð¸Ð¹Ñ‚Ð¸ Ð² Ð½Ð°ÑÑ‚ÑƒÐ¿Ð½Ñƒ. (Ð Ð˜Ð—Ð˜ÐšÐžÐ’ÐÐÐž!)',
    'ðŸ‘  Ð¯ÐºÑ‰Ð¾ Ð²Ð¸ ÐŸÐ¾Ð²Ñ–Ñ. Ð¢Ð° Ð²Ð°Ñ Ð²Ð±Ð¸Ð»Ð¸, Ð¾Ð±Ð¾Ð²â€™ÑÐ·ÐºÐ¾Ð²Ð¾ Ð¿Ð¾Ð²Ñ–Ð´Ð¾Ð¼Ñ‚Ðµ, ÐºÐ¾Ð³Ð¾ Ð²Ð¸ Ð±Ð»Ð¾ÐºÑƒÐ²Ð°Ð»Ð¸ Ð¿Ñ–Ð´ Ñ‡Ð°Ñ Ð³Ñ€Ð¸, Ð°Ð»Ðµ ÑƒÐ½Ð¸ÐºÐ°Ð¹Ñ‚Ðµ Ñ€Ð¾Ð·ÐºÑ€Ð¸Ñ‚Ñ‚Ñ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¸Ñ… Ð¼Ð¸Ñ€Ð½Ð¸Ñ… Ñ€Ð¾Ð»ÐµÐ¹.',
    'ðŸ‘  Ð¯ÐºÑ‰Ð¾ Ð²Ð¸ ÐŸÐ¾Ð²Ñ–Ñ. Ð’Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð¾Ð²ÑƒÐ¹Ñ‚Ðµ ÑÐ²Ð¾ÑŽ Ð·Ð´Ð°Ñ‚Ð½Ñ–ÑÑ‚ÑŒ ÑÑ‚Ñ€Ð°Ñ‚ÐµÐ³Ñ–Ñ‡Ð½Ð¾ â€” Ñ–Ð½ÐºÐ¾Ð»Ð¸ ÐºÑ€Ð°Ñ‰Ðµ Ð·Ð°Ð±Ð»Ð¾ÐºÑƒÐ²Ð°Ñ‚Ð¸ Ð¿Ñ–Ð´Ð¾Ð·Ñ€Ñ–Ð»Ð¾Ð³Ð¾ Ð³Ñ€Ð°Ð²Ñ†Ñ, Ð½Ñ–Ð¶ Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Ð´Ð¾Ñ‚Ñ€Ð¸Ð¼ÑƒÐ²Ð°Ñ‚Ð¸ÑÑ Ñ–Ð½Ñ‚ÑƒÑ—Ñ†Ñ–Ñ—.',
    'ðŸ“° Ð¯ÐºÑ‰Ð¾ Ð²Ð¸ Ð–ÑƒÑ€Ð½Ð°Ð»Ñ–ÑÑ‚ÐºÐ°. Ð£Ð½Ð¸ÐºÐ°Ð¹Ñ‚Ðµ Ð±ÐµÐ·Ð³Ð»ÑƒÐ·Ð´Ð¸Ñ… Ð¿ÐµÑ€ÐµÐ²Ñ–Ñ€Ð¾Ðº. ÐŸÐ°Ð¼\'ÑÑ‚Ð°Ð¹Ñ‚Ðµ: Ð² Ð³Ñ€Ñ– Ñ” Ñ‚Ñ€Ð¸ ÑÑ‚Ð¾Ñ€Ð¾Ð½Ð¸ â€” Ð¼Ð¸Ñ€Ð½Ñ–, Ð¼Ð°Ñ„Ñ–Ñ Ñ‚Ð° Ð½ÐµÐ¹Ñ‚Ñ€Ð°Ð»Ð¸.',
    'ðŸ“° Ð¯ÐºÑ‰Ð¾ Ð²Ð¸ Ð–ÑƒÑ€Ð½Ð°Ð»Ñ–ÑÑ‚ÐºÐ°. Ð’Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð¾Ð²ÑƒÐ¹Ñ‚Ðµ ÑÐ²Ð¾Ñ— Ð¿ÐµÑ€ÐµÐ²Ñ–Ñ€ÐºÐ¸ ÑÑ‚Ñ€Ð°Ñ‚ÐµÐ³Ñ–Ñ‡Ð½Ð¾ â€” Ð²Ð°ÑˆÐ° Ñ–Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ñ–Ñ Ð´Ð¾Ð¿Ð¾Ð¼Ð¾Ð¶Ðµ Ð¼Ñ–ÑÑ‚Ñƒ Ð·Ñ€Ð¾Ð·ÑƒÐ¼Ñ–Ñ‚Ð¸ Ð·Ð°Ð³Ð°Ð»ÑŒÐ½Ñƒ ÐºÐ°Ñ€Ñ‚Ð¸Ð½Ñƒ.',
    'ðŸ“° Ð¯ÐºÑ‰Ð¾ Ð²Ð¸ Ð–ÑƒÑ€Ð½Ð°Ð»Ñ–ÑÑ‚ÐºÐ°. Ð‘ÑƒÐ´ÑŒÑ‚Ðµ ÑƒÐ²Ð°Ð¶Ð½Ñ– Ñ‚Ð° Ð·Ð½Ð°Ð¹Ð´Ñ–Ñ‚ÑŒ Ð½Ð°Ð´Ñ–Ð¹Ð½Ð¾Ð³Ð¾ Ð¼Ð¸Ñ€Ð½Ð¾Ð³Ð¾ Ð³Ñ€Ð°Ð²Ñ†Ñ, Ñ‰Ð¾Ð± Ñ€Ð¾Ð±Ð¸Ñ‚Ð¸ Ð· Ð½Ð¸Ð¼ Ð¿Ð¾Ð´Ð°Ð»ÑŒÑˆÑ– Ð¿ÐµÑ€ÐµÐ²Ñ–Ñ€ÐºÐ¸.',
    'âš–ï¸ Ð¯ÐºÑ‰Ð¾ Ð²Ð¸ ÐÐ´Ð²Ð¾ÐºÐ°Ñ‚ Ð°Ð±Ð¾ Ð‘Ð°Ð»Ð°Ð¼ÑƒÑ‚. ÐŸÐ¸Ð»ÑŒÐ½Ð¾ ÑÑ‚ÐµÐ¶Ñ‚Ðµ Ð·Ð° Ð´Ñ–ÑÐ¼Ð¸ Ð¡Ð»Ñ–Ð´Ñ‡Ð¾Ð³Ð¾. Ð™Ð¾Ð³Ð¾ Ñ€Ñ–ÑˆÐµÐ½Ð½Ñ Ñ‡Ð°ÑÑ‚Ð¾ Ñ„Ð¾Ñ€Ð¼ÑƒÑŽÑ‚ÑŒÑÑ Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ñ– Ñ€ÐµÐ°ÐºÑ†Ñ–Ð¹ Ñ–Ð½ÑˆÐ¸Ñ… Ð³Ñ€Ð°Ð²Ñ†Ñ–Ð² Ð¿Ñ–Ð´ Ñ‡Ð°Ñ Ð³Ð¾Ð»Ð¾ÑÑƒÐ²Ð°Ð½ÑŒ.',
    'ðŸ”ª Ð¯ÐºÑ‰Ð¾ Ð²Ð¸ Ð”Ð¶ÐµÐº-Ð Ñ–Ð·Ð½Ð¸Ðº. Ð¯ÐºÑ‰Ð¾ Ð²Ð°Ð¼ Ð²Ð½Ð¾Ñ‡Ñ– Ð²Ñ–Ð´Ð¾Ð¼Ð¾, Ñ…Ñ‚Ð¾ Ñ” ÐœÐ°Ñ„Ñ–Ñ”ÑŽ Ð°Ð±Ð¾ Ð”Ð¾Ð½Ð¾Ð¼, Ð·Ð¾ÑÐµÑ€ÐµÐ´ÑŒÑ‚Ðµ Ð¿Ð¾ÑˆÑƒÐºÐ¸ ÐŸÐ¾Ð²Ñ–Ñ— ÑÐµÑ€ÐµÐ´ Ð½Ð¸Ñ… â€” Ñ—Ð¹ Ð¿Ð¾Ñ‚Ñ€Ñ–Ð±Ð½Ð¾ Ð±Ð»Ð¾ÐºÑƒÐ²Ð°Ñ‚Ð¸ Ñ—Ð¼ Ñ…Ñ–Ð´.',
    'ðŸ¤ Ð¢Ñ€Ð¸Ð¼Ð°Ð¹Ñ‚Ðµ Ñ–Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ñ–ÑŽ Ð¿Ñ€Ð¸ ÑÐ¾Ð±Ñ–. Ð¯ÐºÑ‰Ð¾ Ð´Ð¾ Ð²Ð°Ñ Ð¿Ñ€Ð¸Ð¹ÑˆÐ¾Ð² Ð›Ñ–ÐºÐ°Ñ€, Ð¡Ð»Ñ–Ð´Ñ‡Ð¸Ð¹ Ð°Ð±Ð¾ ÐŸÐ¾Ð²Ñ–Ñ, Ð½Ðµ Ð¿Ð¾Ð²Ñ–Ð´Ð¾Ð¼Ð»ÑÐ¹Ñ‚Ðµ Ð¿Ñ€Ð¾ Ñ†Ðµ Ð¿ÑƒÐ±Ð»Ñ–Ñ‡Ð½Ð¾.',
    'ðŸ’€ Ð’Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð¾Ð²ÑƒÐ¹Ñ‚Ðµ Ð¾ÑÑ‚Ð°Ð½Ð½Ñ” ÑÐ»Ð¾Ð²Ð¾. Ð¯ÐºÑ‰Ð¾ Ð²Ð°Ñ ÑƒÐ±Ð¸Ð»Ð¸, Ð·Ð°Ð»Ð¸ÑˆÑ‚Ðµ Ð¿Ð¾Ð²Ñ–Ð´Ð¾Ð¼Ð»ÐµÐ½Ð½Ñ Ð· ÐºÐ¾Ñ€Ð¸ÑÐ½Ð¾ÑŽ Ñ–Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ñ–Ñ”ÑŽ Ð¿Ñ€Ð¾ Ð¿ÐµÑ€ÐµÐ²Ñ–Ñ€ÐµÐ½Ð¸Ñ… Ð³Ñ€Ð°Ð²Ñ†Ñ–Ð².',
    'ðŸŒ™ Ð¯ÐºÑ‰Ð¾ Ð²Ð½Ð¾Ñ‡Ñ– Ð½Ðµ ÑÑ‚Ð°Ð»Ð¾ÑÑ Ð²Ð±Ð¸Ð²ÑÑ‚Ð²Ð°, Ñ†Ðµ Ð¼Ð¾Ð¶Ðµ ÑÐ²Ñ–Ð´Ñ‡Ð¸Ñ‚Ð¸ Ð¿Ñ€Ð¾ ÐºÑ–Ð»ÑŒÐºÐ° Ñ€ÐµÑ‡ÐµÐ¹: Ð¼Ð°Ñ„Ñ–Ñ Ð°Ð±Ð¾ Ð¼Ð°Ð½Ñ–ÑÐº Ð¿Ñ€Ð¾Ð¿ÑƒÑÑ‚Ð¸Ð»Ð¸ Ñ…Ñ–Ð´, Ð°Ð±Ð¾ Ð›Ñ–ÐºÐ°Ñ€ Ð²Ñ‡Ð°ÑÐ½Ð¾ Ð²Ð¸Ð»Ñ–ÐºÑƒÐ²Ð°Ð² Ð¶ÐµÑ€Ñ‚Ð²Ñƒ, Ð°Ð±Ð¾ ÐŸÐ¾Ð²Ñ–Ñ Ð·Ð°Ð±Ð»Ð¾ÐºÑƒÐ²Ð°Ð»Ð° Ð´Ñ–ÑŽ Ð¼Ð°Ñ„Ñ–Ð¾Ð·Ñ–.',
    'ðŸ§  Ð¯ÐºÑ‰Ð¾ Ð²Ð¸ ÐœÐ°Ñ„Ñ–Ñ Ð°Ð±Ð¾ Ð”Ð¾Ð½. Ð¢Ð° Ð²Ð°Ñ Ð¿ÐµÑ€ÐµÐ²Ñ–Ñ€Ð¸Ð² Ð¡Ð»Ñ–Ð´Ñ‡Ð¸Ð¹, Ð´Ñ–Ð¹Ñ‚Ðµ ÑˆÐ²Ð¸Ð´ÐºÐ¾ Ð¹ Ñ–Ð¼Ð¿Ñ€Ð¾Ð²Ñ–Ð·ÑƒÐ¹Ñ‚Ðµ, Ñ‰Ð¾Ð± Ð²Ð²ÐµÑÑ‚Ð¸ Ð¼Ñ–ÑÑ‚Ð¾ Ð² Ð¾Ð¼Ð°Ð½Ñƒ.',
    'ðŸ“š Ð©Ð°ÑÐ»Ð¸Ð²Ð° Ð¿Ð¾Ñ€Ð°Ð´Ð° â€” Ñ‡Ð¸Ñ‚Ð°Ð¹Ñ‚Ðµ, Ð³Ñ€Ð°Ð¹Ñ‚Ðµ, Ð½Ð°Ð²Ñ‡Ð°Ð¹Ñ‚ÐµÑÑŒ. Ð”Ð¾ÑÐ²Ñ–Ð´ Ð²Ð°Ñˆ Ð½Ð°Ð¹Ñ†Ñ–Ð½Ð½Ñ–ÑˆÐ¸Ð¹ Ñ€ÐµÑÑƒÑ€Ñ!'
];


let timeout: NodeJS.Timeout | null = null;
let remainingTime = 120 * 1000;
let startTime = Date.now();
let initiatorId: number | null = null;

const resetTimer = (ctx: any) => {
    const randomTip = tips[Math.floor(Math.random() * tips.length)];
    ctx.reply(`! ${randomTip}\n\n[Moonlight Escort Mafia](https://t.me/+JjjF-m8cPs1kNTUy) | [Bot](https://t.me/mlesmafia_bot)`, { parse_mode: 'Markdown', disable_web_page_preview: true});

    if (timeout) clearTimeout(timeout);
    timeout = null;
    remainingTime = 120 * 1000;
    initiatorId = null;
};

const launchTimer = async (ctx: any) => {
    if (timeout) {
        resetTimer(ctx);
        return;
    }

    initiatorId = ctx.from.id;
    startTime = Date.now();

    console.log('ðŸ” ÐžÑ‡Ñ–ÐºÑƒÑ”Ð¼Ð¾ 2 Ñ…Ð²... ÐÐ°Ð¿Ð¸ÑˆÑ–Ñ‚ÑŒ "/extend @mafiagamebot" Ñ‰Ð¾Ð± Ð¿Ð¾Ð´Ð¾Ð²Ð¶Ð¸Ñ‚Ð¸.');

    timeout = setTimeout(() => {
        resetTimer(ctx);
    }, remainingTime);
};

const cancelTimer = () => {
    if (timeout) {
        clearTimeout(timeout);
        timeout = null;
        remainingTime = 120 * 1000;
        initiatorId = null;
        console.log('âŒ ÐžÑ‡Ñ–ÐºÑƒÐ²Ð°Ð½Ð½Ñ ÑÐºÐ°ÑÐ¾Ð²Ð°Ð½Ð¾.');
    } else {
        console.log('âš ï¸ ÐÐµÐ¼Ð°Ñ” Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾Ð³Ð¾ Ñ‚Ð°Ð¹Ð¼ÐµÑ€Ð°.');
    }
};

const extractCommand = (text: string) => {
    const tokens = text.trim().split(/\s+/);
    const fullCommand = tokens[0].toLowerCase(); // Ð½Ð°Ð¿Ñ€Ð¸ÐºÐ»Ð°Ð´, "/start@MafiaUaBot"
    const baseCommand = fullCommand.split('@')[0]; // "/start"
    const mention = fullCommand.includes('@') ? fullCommand.split('@')[1] : null;
    const value = parseInt(tokens[1]) || null;

    return { baseCommand, mention, value };
};


const isFromAllowedUser = async (ctx: any) => {
    const fromId = ctx.from.id;

    if (fromId === initiatorId) return true;

    const chatId = ctx.chat.id;
    try {
        const admins = await ctx.getChatAdministrators();
        return admins.some((admin: any) => admin.user.id === fromId);
    } catch (error) {
        console.log('âš ï¸ ÐÐµ Ð²Ð´Ð°Ð»Ð¾ÑÑ Ð¾Ñ‚Ñ€Ð¸Ð¼Ð°Ñ‚Ð¸ ÑÐ¿Ð¸ÑÐ¾Ðº Ð°Ð´Ð¼Ñ–Ð½Ñ–ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ñ–Ð² Ñ‡Ð°Ñ‚Ñƒ');
        return false;
    }
};

bot.on('text', async (ctx) => {
    const text = ctx.message.text;
    const { baseCommand, mention, value } = extractCommand(text);

    // ÑÐºÑ‰Ð¾ Ð·Ð³Ð°Ð´ÐºÐ° Ñ” â€” Ñ– Ð²Ð¾Ð½Ð° ÐÐ• @mafiagamebot â†’ Ñ–Ð³Ð½Ð¾Ñ€ÑƒÑ”Ð¼Ð¾
    if (mention && mention.toLowerCase() !== targetBotMention) return;

    const allowed = await isFromAllowedUser(ctx);
    if (!allowed) {
        console.log(`ðŸš« ÐšÐ¾Ñ€Ð¸ÑÑ‚ÑƒÐ²Ð°Ñ‡ ${ctx.from.username || ctx.from.id} Ð½Ðµ Ð¼Ð°Ñ” Ð¿Ñ€Ð°Ð²`);
        return;
    }

    switch (baseCommand) {
        case '/start':
        case '/game':
            await launchTimer(ctx);
            break;

        case '/extend':
            if (!timeout) {
                console.log('â±ï¸ ÐÐµÐ¼Ð°Ñ” Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾Ð³Ð¾ Ñ‚Ð°Ð¹Ð¼ÐµÑ€Ð°. ÐÐ°Ð¿Ð¸ÑˆÑ–Ñ‚ÑŒ /start.');
                return;
            }

            const addTime = value ? value * 1000 : 30 * 1000;
            const elapsed = Date.now() - startTime;
            remainingTime = Math.max(0, remainingTime - elapsed + addTime);
            startTime = Date.now();

            clearTimeout(timeout);
            timeout = setTimeout(() => {
                resetTimer(ctx);
            }, remainingTime);

            console.log(`â³ Ð¢Ð°Ð¹Ð¼ÐµÑ€ Ð¿Ð¾Ð´Ð¾Ð²Ð¶ÐµÐ½Ð¾. ÐÐ¾Ð²Ð° Ð·Ð°Ñ‚Ñ€Ð¸Ð¼ÐºÐ°: ${Math.floor(remainingTime / 1000)} ÑÐµÐº.`);
            break;

        case '/stop':
            cancelTimer();
            break;

        default:
            break;
    }
});
bot.launch();
console.log('âœ… Ð‘Ð¾Ñ‚ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½Ð¾');

process.once('SIGINT', () => bot.stop('SIGINT'));
process.once('SIGTERM', () => bot.stop('SIGTERM'));
